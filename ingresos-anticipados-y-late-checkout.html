<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>Health Survey</h1>
    <h2>Diagnostic for applicants to our fitness program.</h2>

    <iframe name="hiddenConfirm" id="hiddenConfirm" style="display: none" frameborder="0"></iframe>
    <form
      action="https://docs.google.com/forms/d/e/xxxxxxxxxxxxxxxxxxxx/formResponse"
      id="form"
      method="POST"
      target="hiddenConfirm"
    >
      <label for="comfort">What is your go-to comfort food?</label>
      <input name="entry.1608074211" type="text" id="comfort" />
      <input name="entry.2053464848" type="text" placeholder="drugi" />

      <input class="button" type="submit" value="Submit" />
    </form>

    <script>
      (function () {
        let iframeId = 1;
        const formEl = document.getElementById("form");

        const generateIframe = () => {
          const iframe = document.createElement("iframe");
          iframe.name = "hiddenConfirm";
          iframe.id = `hiddenConfirm-${iframeId}`;
          iframe.style.display = "none";
          iframe.frameBorder = "0";
          document.body.appendChild(iframe);
          return iframe;
        };

        // let hiddenConfirmEl = generateIframe();
        let hiddenConfirmEl = document.getElementById("hiddenConfirm");
        hiddenConfirmEl.onload = function () {
          alert("hiddenConfirmEl loaded");
          // iframeId++;
          // hiddenConfirmEl = generateIframe();
          // formEl.target = hiddenConfirmEl.name;
        };

        // formEl.addEventListener("submit", function (event) {
        //   event.preventDefault();
        //   const formData = new FormData(formEl); // Create a FormData object from the form

        //   fetch(formEl.action, {
        //     method: formEl.method,
        //     body: formData,
        //     headers: { "X-Requested-With": "XMLHttpRequest" },
        //   })
        //     .then((response) => {
        //       console.log("Response:", response);
        //       debugger;
        //       if (!response.ok) {
        //         throw new Error("Network response was not ok");
        //       }
        //       return response.json(); // Assuming the server responds with JSON
        //     })
        //     .then((data) => {
        //       console.log("Success:", data);
        //       debugger;
        //       // Handle success (e.g., show a success message, redirect, etc.)
        //     })
        //     .catch((error) => {
        //       console.error("Error:", error);
        //       debugger;
        //       // Handle error (e.g., show an error message)
        //     });
        // });
      })();
    </script>
  </body>
</html>
